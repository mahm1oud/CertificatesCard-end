import{n as fe,r,j as s,h as Z,c as F,o as we,a as ve,q as je,b as le,g as oe,i as V,B as w,X as ye,l as D,m as re}from"./index-DoMHCGG2.js";import{S as be}from"./share-options-Dq3pJXip.js";import{S as Ne,L as Ie,I as Se,T as Ue}from"./ReactKonvaCore-0IBzjN_D.js";import{F as $e}from"./FieldsPositionEditor-_KSUMmZv.js";import{S as Ce,a as Ee,b as Fe,c as Le,d as A}from"./select-CRu623qS.js";import{D as me,a as Re,b as ge,c as ue,d as pe,e as he}from"./dialog-fsPDLJiu.js";import{R as ke}from"./refresh-cw-sltvKsd-.js";import{E as ze}from"./eye-Co1cENxs.js";import{P as Te}from"./palette-Bp1rK65v.js";import{D as ce}from"./download-CkzZtpS5.js";import{S as de}from"./save-CRRscGsZ.js";import"./scroll-area-BaWF6YIt.js";import"./index-BdQq_4o_.js";import"./tabs-CKJmMpcu.js";import"./image-CRCqvbIG.js";import"./twitter-BkFCnlyo.js";import"./instagram-BWPAtAad.js";import"./share-2-C3FB-j83.js";import"./qr-code-BYf2XRjA.js";import"./copy-DCUs-YoJ.js";import"./input-COMsjQRu.js";import"./label-DSWK9Bhr.js";import"./switch-DKvoDZdm.js";import"./slider-ef3OeGSW.js";import"./alert-DFZX5DlC.js";import"./rotate-ccw-JEJsQ_rj.js";import"./rotate-cw-CTNsAp4T.js";import"./zoom-out-eiDS2u6d.js";import"./maximize-ghBMrwjq.js";import"./magnet-CnbLQg6V.js";import"./trash-2-Dn6YYs7e.js";import"./form-DyTRWEbF.js";import"./badge-D9F70VlA.js";import"./layers-D3_CD2xn.js";import"./chevron-up-DgjV3eGa.js";import"./type-DWs-uHqd.js";import"./file-image-CUREGKCZ.js";import"./align-right-D7bOis_1.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=fe("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),J=1e3,De=({templateImage:j,fields:y=[],formData:h={},width:d=800,height:o=600,onImageGenerated:b,className:m="",quality:g="preview"})=>{const I=r.useRef(null),[f,v]=r.useState(null),[l,u]=r.useState({width:d,height:o}),a=r.useMemo(()=>h._designFields&&Array.isArray(h._designFields)&&h._designFields.length>0?(console.log("استخدام حقول التصميم المخصصة:",h._designFields.length),h._designFields):(console.log("استخدام حقول التصميم الأصلية:",y.length),y),[y,h._designFields]);r.useEffect(()=>{if(!j)return;const i=new window.Image;i.crossOrigin="anonymous",i.src=j,i.onload=()=>{v(i);const n=i.width/i.height;console.log(`Original Image: ${i.width}x${i.height}, ratio: ${n}`),console.log(`BASE_IMAGE_WIDTH: ${J}`);let p,x;if(d&&!o)p=d,x=d/n;else if(o&&!d)x=o,p=o*n;else if(d&&o){const U=d/i.width,L=o/i.height,$=Math.min(U,L);p=i.width*$,x=i.height*$}else p=Math.min(J,window.innerWidth-40),x=p/n;console.log(`Using stage size: ${p}x${x}`),u({width:p,height:x})}},[j,d,o]);const S=i=>(h[i.name]??i.defaultValue??i.label??"").toString(),N=i=>{var z,T,M;const n=i.style||{},p=n.fontFamily||"Cairo",x=l.width/J;let U=n.fontSize||24;U<14&&(U=14),U>60&&(U=60);const L=Math.round(U*x),$=n.fontWeight||"normal",B=$==="bold"?"bold":"normal",H=i.position.x/100*l.width,R=i.position.y/100*l.height,_=n.align||"center";let O=0;_==="center"&&(O=0);const q=n.maxWidth?Math.round((n.maxWidth||200)*x):Math.round(l.width-50*x),k=((z=n.textShadow)==null?void 0:z.enabled)||!1,C=k?((T=n.textShadow)==null?void 0:T.color)||"rgba(0, 0, 0, 0.5)":"transparent",K=k?(((M=n.textShadow)==null?void 0:M.blur)||3)*x:0,P=k?2*x:0,W=k?2*x:0,G=n.color||"#000000";console.log(`Field ${i.name}: font="${p} ${$} ${L}px", color=${G}, scaleFactor=${x.toFixed(2)}, x=${H}, y=${R}`);const Q=i.rotation||0;return{text:S(i),x:H,y:R,fontSize:L,fontFamily:p,fontStyle:B,fill:G,align:_,width:q,offsetX:O,rotation:Q,shadowColor:C,shadowBlur:K,shadowOffset:{x:P,y:W},visible:i.visible!==!1,perfectDrawEnabled:!0}},e=()=>{if(!I.current)return;let i;g==="high"?i=2:g==="medium"?i=1.5:i=1,console.log(`Generating preview image with pixelRatio: ${i}`);const n=I.current.toDataURL({pixelRatio:i,mimeType:"image/png",quality:1});console.log(`Generated image data URL length: ${n.length}`),b&&b(n)};return r.useEffect(()=>{if(f&&I.current){const i=setTimeout(()=>{console.log("Generating image after elements loaded"),e()},200);return()=>clearTimeout(i)}},[f,a,h,l,g]),s.jsx("div",{className:`relative ${m}`,children:s.jsx(Ne,{ref:I,width:l.width,height:l.height,style:{margin:"0 auto"},children:s.jsxs(Ie,{children:[f&&s.jsx(Se,{image:f,width:l.width,height:l.height,perfectDrawEnabled:!0}),[...a].sort((i,n)=>(i.zIndex||0)-(n.zIndex||0)).map((i,n)=>s.jsx(Ue,{...N(i)},`${i.name}-${n}`))]})})})},Oe=({templateImage:j,fields:y=[],formData:h={},width:d=800,height:o=600,onImageGenerated:b,onError:m,className:g="",quality:I="medium"})=>{const{toast:f}=Z(),[v,l]=r.useState(!1),a=(e=>e?e.startsWith("data:")||e.startsWith("http")?e:(e.includes("/temp/")&&(e=e.replace("/temp/","/uploads/")),e.includes("/uploads/generated/")||e.includes("/generated/")&&(e=e.replace("/generated/","/uploads/generated/")),e.startsWith("/")||(e="/"+e),window.location.origin+e):"")(j),S=e=>{l(!1),b&&b(e)},N=e=>{l(!1),console.error("Error generating image:",e),m?m(e):f({title:"خطأ",description:e.message||"حدث خطأ أثناء توليد الصورة",variant:"destructive"})};return s.jsx("div",{className:`konva-image-generator ${g}`,children:v?s.jsxs("div",{className:"flex items-center justify-center p-4",children:[s.jsx(F,{className:"w-8 h-8 animate-spin mr-2"}),s.jsx("span",{children:"جاري توليد الصورة..."})]}):s.jsx(De,{templateImage:a,fields:y,formData:h,width:d,height:o,onImageGenerated:S,onError:N,className:g,quality:I})})},Is=()=>{var ie,ae,ne;const j=we(),{category:y,templateId:h,cardId:d}=j;console.log("URL Params:",j);const[o,b]=ve();r.useState(!1);const{toast:m}=Z(),g=je(),[I,f]=r.useState(!1),[v,l]=r.useState(null),[u,a]=r.useState(!1),[S,N]=r.useState(!1),{data:e,isLoading:i,error:n}=le({queryKey:[`/api/cards/${d}`],queryFn:oe({on401:"redirect-to-login"}),enabled:!!d,retry:1}),{data:p=[],isLoading:x}=le({queryKey:[`/api/templates/${e==null?void 0:e.templateId}/public-fields`],queryFn:oe({on401:"returnNull"}),enabled:!!(e!=null&&e.templateId),retry:3,staleTime:6e4});r.useEffect(()=>{e&&console.log("Card data loaded:",{id:e.id,publicId:e.publicId,templateId:e.templateId,imageUrl:e.imageUrl,formData:e.formData})},[e]),r.useEffect(()=>{p&&p.length>0?console.log("Template fields loaded:",p):e!=null&&e.templateId&&console.log("No template fields found for template ID:",e.templateId)},[p,e==null?void 0:e.templateId]),r.useEffect(()=>{if(e&&e.imageUrl){console.log("Checking image URL:",e.imageUrl);const t=e.imageUrl.includes("?")?`${e.imageUrl}&quality=preview`:`${e.imageUrl}?quality=preview`;l(t);const c=e.imageUrl.includes("/generated/")?e.imageUrl:e.imageUrl.replace("/uploads/","/uploads/generated/"),E=c.includes("?")?`${c}&quality=low`:`${c}?quality=low`,X=new Image;X.onload=()=>{console.log("Image loaded successfully:",E),l(E)},X.onerror=()=>{console.log("Optimized URL failed, trying original URL:",e.imageUrl);const Y=new Image;Y.src=e.imageUrl,Y.onload=()=>{console.log("Original URL loaded successfully"),l(e.imageUrl)},Y.onerror=()=>{console.log("Both URLs failed, will regenerate image"),l(null)}},X.src=E}else l(null)},[e]);const U=async t=>{try{if(console.log("Image generated successfully, data URL length:",t.length),f(!1),l(t),u&&e){console.log("Uploading regenerated image to server...");try{const c=await D("POST",`/api/cards/${e.id}/update-image`,{imageData:t},{timeout:2e4});c&&c.imageUrl?(console.log("Image updated successfully, new URL:",c.imageUrl),g.setQueryData([`/api/cards/${d}`],E=>E&&{...E,imageUrl:c.imageUrl}),l(c.imageUrl),m({title:"تم تحديث الصورة",description:"تم إعادة توليد صورة البطاقة بنجاح"})):console.warn("Image update succeeded but no URL returned")}catch(c){console.error("Error uploading regenerated image:",c),console.log("Using locally generated image as fallback")}a(!1),N(!0)}}catch(c){console.error("Error in image generation process:",c),f(!1),a(!1),m({title:"خطأ في التحديث",description:"حدث خطأ أثناء تحديث صورة البطاقة",variant:"destructive"})}},L=t=>{console.error("Error generating image:",t),f(!1),a(!1),m({title:"خطأ في توليد الصورة",description:t.message||"حدث خطأ أثناء توليد صورة البطاقة",variant:"destructive"})},$=()=>{a(!0),l(null)},B=async t=>{console.log("تم تحديث حقول التصميم:",t),G(t),a(!0),l(null);try{e!=null&&e.id&&e.status==="saved"&&(await D("PATCH",`/api/cards/${e.id}/update-design`,{fields:t}),m({title:"تم التحديث",description:"تم تحديث تصميم البطاقة وحفظ التغييرات"}))}catch(c){console.error("خطأ في تحديث التصميم:",c),console.log("سيتم استخدام التصميم المحدث محلياً فقط")}},H=()=>{e&&e.publicId?(console.log(`Navigating to view card with publicId: ${e.publicId}`),b(`/view/${e.publicId}`)):console.error("Cannot view card: missing publicId")},[R,_]=r.useState("medium"),[O,q]=r.useState(!1),[k,C]=r.useState(!1),[K,P]=r.useState(!1),[W,G]=r.useState([]),Q=V({mutationFn:async()=>await D("PATCH",`/api/cards/${e==null?void 0:e.id}`,{status:"saved",isPreview:!1}),onSuccess:()=>{m({title:"تم الحفظ",description:"تم حفظ البطاقة في نماذجك بنجاح"}),C(!1),g.setQueryData([`/api/cards/${d}`],t=>t&&{...t,status:"saved"})},onError:t=>{m({title:"خطأ في الحفظ",description:t instanceof Error?t.message:"حدث خطأ أثناء حفظ البطاقة",variant:"destructive"})}}),z=V({mutationFn:async()=>await D("PATCH",`/api/cards/${e==null?void 0:e.id}`,{status:"draft",isPreview:!1,quality:"preview"}),onSuccess:()=>{g.invalidateQueries({queryKey:["/api/user/cards"]}),m({title:"تم الحفظ كمسودة",description:"تم حفظ البطاقة كمسودة ويمكنك تعديلها لاحقاً من صفحة نماذجي"})},onError:t=>{m({title:"خطأ في الحفظ",description:t instanceof Error?t.message:"حدث خطأ أثناء حفظ المسودة",variant:"destructive"})}}),T=V({mutationFn:async()=>await D("DELETE",`/api/cards/${e==null?void 0:e.id}`,{}),onSuccess:()=>{m({title:"تم الحذف",description:"تم حذف البطاقة بنجاح"}),C(!1),b(`/cards/${y||"other"}/${h}`)},onError:t=>{m({title:"خطأ في الحذف",description:t instanceof Error?t.message:"حدث خطأ أثناء حذف البطاقة",variant:"destructive"})}}),M=V({mutationFn:async t=>(console.log(`Requesting download with quality: ${t}`),{...await D("POST",`/api/cards/${e==null?void 0:e.id}/download`,{quality:t}),usedQuality:t}),onSuccess:t=>{if(t!=null&&t.imageUrl){const c=`بطاقة-${(e==null?void 0:e.id)||"custom"}-${t.usedQuality||R}.png`;console.log(`Downloading image: ${t.imageUrl} with filename: ${c}`),re(t.imageUrl,c),m({title:"تم التنزيل",description:`تم تنزيل البطاقة بنجاح بجودة ${t.usedQuality==="low"?"منخفضة":t.usedQuality==="medium"?"متوسطة":t.usedQuality==="high"?"عالية":"ممتازة"}`})}else ee()},onError:()=>{ee()}}),ee=()=>{const t=v||e&&e.imageUrl;if(t){const c=`بطاقة-${(e==null?void 0:e.id)||"custom"}.png`;re(t,c)}else m({title:"تعذر التحميل",description:"الصورة غير متوفرة للتحميل حالياً",variant:"destructive"})},se=()=>{O?(M.mutate(R),q(!1)):q(!0)},xe=i,te=x||v===null&&!n;return xe?s.jsx("div",{className:"fixed inset-0 bg-black/50 z-30 flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-auto mx-4 p-6 text-center",children:[s.jsx(F,{className:"w-8 h-8 animate-spin mx-auto mb-4"}),"جاري تحميل البطاقة..."]})}):n||!e?s.jsx("div",{className:"fixed inset-0 bg-black/50 z-30 flex items-center justify-center",children:s.jsxs("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-auto mx-4 p-6 text-center",children:[s.jsx("p",{className:"text-red-500 mb-4",children:"حدث خطأ أثناء تحميل البطاقة"}),s.jsx(w,{onClick:()=>window.history.back(),children:"العودة"})]})}):s.jsxs("div",{className:"fixed inset-0 bg-black/60 z-30 flex items-center justify-center",children:[s.jsxs("div",{className:"bg-white rounded-lg w-full h-[95vh] max-h-[95vh] overflow-hidden mx-2 flex flex-col",children:[s.jsxs("div",{className:"p-3 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[s.jsx("h3",{className:"text-xl font-bold text-neutral-800",children:"معاينة البطاقة"}),s.jsx(w,{variant:"ghost",size:"icon",className:"text-neutral-500 hover:text-neutral-700",onClick:()=>b(`/cards/${y||"other"}/${h}`),children:s.jsx(ye,{className:"h-5 w-5"})})]}),s.jsx("div",{className:"flex-1 overflow-auto p-3 md:p-4 flex flex-col",children:s.jsx("div",{className:"flex-1 flex items-center justify-center bg-gray-100 rounded-lg p-2 md:p-4",children:s.jsxs("div",{className:"relative max-w-3xl h-full flex items-center justify-center",children:[te?s.jsx("div",{className:"rounded-md shadow-md bg-white flex items-center justify-center",style:{aspectRatio:"3/4",minHeight:"300px"},children:s.jsxs("div",{className:"text-center p-4",children:[s.jsx(F,{className:"w-10 h-10 animate-spin mb-2 mx-auto text-primary"}),s.jsx("p",{className:"text-sm text-gray-600",children:"جاري تحميل الصورة..."})]})}):v?s.jsx("img",{src:v,alt:((ie=e.template)==null?void 0:ie.title)||"البطاقة المخصصة",className:"w-auto h-auto object-contain rounded-md shadow-md max-h-[calc(95vh-140px)] max-w-full",loading:"lazy"}):s.jsx("div",{className:"rounded-md shadow-md bg-white flex items-center justify-center",style:{maxHeight:"calc(95vh - 140px)",minHeight:"600px"},children:s.jsx(Oe,{templateImage:((ae=e.template)==null?void 0:ae.imageUrl)||"",fields:W.length>0?W:p,formData:e.formData||{},width:500,height:700,onImageGenerated:U,onError:L,className:"max-h-[calc(95vh_-_140px)] max-w-full object-contain"})}),!u&&!I&&!te&&s.jsxs(w,{size:"sm",variant:"secondary",className:"absolute bottom-2 right-2 opacity-80 hover:opacity-100",onClick:$,children:[s.jsx(ke,{className:"h-4 w-4 mr-1"}),"إعادة توليد"]})]})})}),s.jsx("div",{className:"border-t border-gray-200 p-3 bg-gray-50",children:s.jsxs("div",{className:"flex flex-wrap gap-2 justify-between items-center",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(w,{variant:"default",onClick:H,className:"flex items-center gap-1",disabled:!v&&!e.imageUrl,size:"sm",children:[s.jsx(ze,{className:"h-4 w-4"}),"عرض"]}),s.jsxs(w,{variant:"outline",onClick:()=>P(!0),className:"flex items-center gap-1",size:"sm",children:[s.jsx(Te,{className:"h-4 w-4"}),"تعديل التصميم"]}),O?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsxs(Ce,{value:R,onValueChange:t=>_(t),children:[s.jsx(Ee,{className:"h-9 w-28",children:s.jsx(Fe,{placeholder:"اختر الجودة"})}),s.jsxs(Le,{children:[s.jsx(A,{value:"low",children:"منخفضة"}),s.jsx(A,{value:"medium",children:"متوسطة"}),s.jsx(A,{value:"high",children:"عالية"}),s.jsx(A,{value:"download",children:"ممتازة"})]})]}),s.jsxs(w,{variant:"secondary",onClick:se,disabled:M.isPending,size:"sm",children:[M.isPending?s.jsx(F,{className:"h-4 w-4 animate-spin"}):s.jsx(ce,{className:"h-4 w-4"}),"تنزيل"]})]}):s.jsxs(w,{variant:"secondary",onClick:se,className:"flex items-center gap-1",disabled:!v&&!e.imageUrl,size:"sm",children:[s.jsx(ce,{className:"h-4 w-4"}),"تنزيل"]}),s.jsx(be,{cardId:e.id||e.publicId,imageUrl:v||e.imageUrl,size:"sm",templateId:e.templateId})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(me,{open:k,onOpenChange:C,children:[s.jsx(Re,{asChild:!0,children:s.jsxs(w,{variant:"outline",className:"flex items-center gap-1",size:"sm",children:[s.jsx(de,{className:"h-4 w-4"}),"حفظ"]})}),s.jsxs(ge,{children:[s.jsxs(ue,{children:[s.jsx(pe,{children:"حفظ البطاقة"}),s.jsx(he,{children:"يمكنك حفظ البطاقة في نماذجك للرجوع إليها لاحقاً أو حفظها كمسودة لتعديلها لاحقاً."})]}),s.jsxs("div",{className:"flex flex-col space-y-4 mt-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs(w,{variant:"default",onClick:()=>Q.mutate(),disabled:Q.isPending,className:"w-full",children:[Q.isPending?s.jsx(F,{className:"h-4 w-4 animate-spin mr-2"}):s.jsx(de,{className:"h-4 w-4 mr-2"}),"حفظ البطاقة"]}),s.jsxs(w,{variant:"outline",onClick:()=>{z.mutate(),C(!1)},disabled:z.isPending,className:"w-full",children:[z.isPending?s.jsx(F,{className:"h-4 w-4 animate-spin mr-2"}):s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-4 w-4 mr-2",children:[s.jsx("path",{d:"M14 3c.3 0 .5.1.7.3L20 8.6c.2.2.3.4.3.7V18c0 .6-.2 1-.6 1.4-.4.4-.8.6-1.4.6H5.6c-.6 0-1-.2-1.4-.6-.4-.4-.6-.8-.6-1.4V5.6c0-.6.2-1 .6-1.4.4-.4.8-.6 1.4-.6H14z"}),s.jsx("path",{d:"M15 3v5c0 .6.2 1 .6 1.4.4.4.8.6 1.4.6h5"}),s.jsx("path",{d:"m9 15 3 3 3-3"}),s.jsx("path",{d:"M12 9v9"})]}),"حفظ كمسودة"]})]}),s.jsx(w,{variant:"ghost",onClick:()=>C(!1),className:"w-full",children:"إلغاء"})]})]})]}),s.jsxs(w,{variant:"outline",className:"flex items-center gap-1 text-red-500 border-red-200 hover:bg-red-50",onClick:()=>T.mutate(),disabled:T.isPending,size:"sm",children:[T.isPending?s.jsx(F,{className:"h-4 w-4 animate-spin"}):s.jsx(Me,{className:"h-4 w-4"}),"عدم الحفظ"]})]})]})})]}),s.jsx(Qe,{isOpen:K,onClose:()=>P(!1),templateId:e.templateId,templateFields:p,formData:e.formData||{},templateImage:((ne=e.template)==null?void 0:ne.imageUrl)||e.imageUrl||"",onFieldsUpdated:B})]})},Qe=({isOpen:j,onClose:y,templateId:h,templateFields:d,formData:o,templateImage:b,onFieldsUpdated:m})=>{const[g,I]=r.useState([]),{toast:f}=Z();r.useEffect(()=>{if(j&&d&&d.length>0){console.log("البيانات المدخلة:",o);const u=d.map(a=>{let S=a.type;S!=="text"&&S!=="image"&&S!=="template"&&(S="text");let N=a.position;(!N||typeof N!="object")&&(N={x:50,y:50});const e=a.style||{},i={id:a.id,name:a.name,label:a.label||a.name,type:S,position:{x:N.x,y:N.y,snapToGrid:N.snapToGrid||!1},style:e,visible:!0,zIndex:e.zIndex||e.layer||1,rotation:e.rotation||0,size:{width:e.width||200,height:e.height||50}};return o&&o[a.name]!==void 0&&(a.type==="image"&&typeof o[a.name]=="string"?(i.defaultValue=o[a.name],i.imageUrl=o[a.name]):(i.defaultValue=o[a.name],i.value=o[a.name])),i});console.log("الحقول المحولة للمحرر:",u),I(u)}},[j,d,o]);const v=()=>{try{if(console.log("حفظ الحقول المعدلة:",g),!g||g.length===0){f({title:"تنبيه",description:"لا توجد حقول لحفظها. تأكد من وجود الحقول في التصميم.",variant:"warning"});return}const u=g.map(a=>({...a,visible:a.visible===!1?void 0:a.visible||!0}));console.log("الحقول بعد التحقق من visible:",u),m(u),f({title:"تم الحفظ",description:"تم حفظ تغييرات التصميم بنجاح. الآن يمكنك رؤية التغييرات في البطاقة."}),y()}catch(u){console.error("خطأ أثناء حفظ التصميم:",u),f({title:"خطأ في الحفظ",description:"حدث خطأ أثناء حفظ التصميم، يرجى المحاولة مرة أخرى",variant:"destructive"})}},l=u=>{I(u)};return s.jsx(me,{open:j,onOpenChange:u=>!u&&y(),children:s.jsx(ge,{className:"max-w-[95vw] w-[95vw] h-[95vh] max-h-[95vh] p-0 overflow-hidden",children:s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs(ue,{className:"p-4 border-b",children:[s.jsx(pe,{children:"تعديل تصميم البطاقة"}),s.jsx(he,{children:"يمكنك تعديل مظهر العناصر وموضعها في البطاقة هنا. اسحب العناصر لتغيير مواضعها."})]}),s.jsxs("div",{className:"flex-1 overflow-auto p-0",children:[console.log("Sending to editor - ID:",h),console.log("Sending to editor - Fields:",g),console.log("Sending to editor - FormData:",o),console.log("Sending to editor - Image:",b),s.jsx($e,{templateId:h,initialFields:g,formData:o,templateImage:b,onChange:l,readOnly:!1,embedded:!0})]}),s.jsxs("div",{className:"p-4 border-t flex justify-between",children:[s.jsx(w,{variant:"outline",onClick:y,children:"إلغاء"}),s.jsx(w,{onClick:v,children:"حفظ التغييرات"})]})]})})})};export{Is as default};
