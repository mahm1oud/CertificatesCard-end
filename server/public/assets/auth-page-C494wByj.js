import{n as y,h as M,r as f,b as R,i as U,j as e,c as b,M as k,C as m,s as d,t as o,v as h,d as p,B as D,l as H,W as V,g as I}from"./index-DoMHCGG2.js";import{I as n}from"./input-COMsjQRu.js";import{L as i}from"./label-DSWK9Bhr.js";import{S as l}from"./switch-DKvoDZdm.js";import{T as A,a as K,b as x,c as u}from"./tabs-CKJmMpcu.js";import{S as Q}from"./save-CRRscGsZ.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=y("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=y("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=y("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);function X(){const{toast:j}=M(),[v,N]=f.useState(!1),[a,t]=f.useState({enableRegistration:!0,requireEmailVerification:!0,allowPasswordReset:!0,sessionTimeout:86400,rememberMeDuration:30,minPasswordLength:8,requireUppercase:!0,requireLowercase:!0,requireNumbers:!0,requireSpecialChars:!0,passwordExpirationDays:90,passwordHistory:3,smtpHost:"",smtpPort:587,smtpUsername:"",smtpPassword:"",smtpFromEmail:"",smtpFromName:"نظام الشهادات",smtpSecure:!0}),{isLoading:P}=R({queryKey:["/api/admin/settings/auth"],queryFn:I({}),onSuccess:s=>{s&&s.settings&&t(r=>({...r,...s.settings}))},onError:s=>{console.error("Error fetching auth settings:",s),j({title:"خطأ في جلب الإعدادات",description:"حدث خطأ أثناء جلب إعدادات المصادقة",variant:"destructive"})}}),g=U({mutationFn:async s=>await H("/api/admin/settings/auth",{method:"POST",body:{settings:s}}),onSuccess:()=>{j({title:"تم حفظ الإعدادات",description:"تم حفظ إعدادات المصادقة بنجاح"}),V.invalidateQueries({queryKey:["/api/admin/settings/auth"]})},onError:s=>{j({title:"خطأ في حفظ الإعدادات",description:"حدث خطأ أثناء حفظ إعدادات المصادقة",variant:"destructive"}),console.error("Error saving auth settings:",s)}}),E=s=>{s.preventDefault(),N(!0),g.mutate(a,{onSettled:()=>{N(!1)}})},c=s=>{const{name:r,value:w,type:C,checked:L}=s.target;t(T=>({...T,[r]:C==="checkbox"?L:C==="number"?parseFloat(w):w}))};return e.jsxs("div",{className:"container mx-auto py-6 space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"إعدادات المصادقة"}),e.jsx("p",{className:"text-muted-foreground",children:"إدارة إعدادات تسجيل الدخول وكلمات المرور وجلسات المستخدمين"})]})}),P?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx(b,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs(A,{defaultValue:"general",className:"space-y-6",children:[e.jsxs(K,{className:"grid grid-cols-1 md:grid-cols-4",children:[e.jsxs(x,{value:"general",children:[e.jsx(F,{className:"ml-2 h-4 w-4"}),"إعدادات عامة"]}),e.jsxs(x,{value:"password",children:[e.jsx(S,{className:"ml-2 h-4 w-4"}),"كلمات المرور"]}),e.jsxs(x,{value:"session",children:[e.jsx(q,{className:"ml-2 h-4 w-4"}),"الجلسات"]}),e.jsxs(x,{value:"email",children:[e.jsx(k,{className:"ml-2 h-4 w-4"}),"إعدادات البريد الإلكتروني"]})]}),e.jsx(u,{value:"general",className:"space-y-6",children:e.jsxs(m,{children:[e.jsxs(d,{children:[e.jsxs(o,{className:"flex items-center",children:[e.jsx(F,{className:"ml-2 h-5 w-5"}),"إعدادات التسجيل والمصادقة"]}),e.jsx(h,{children:"تكوين خيارات التسجيل وتسجيل الدخول"})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(l,{id:"enableRegistration",name:"enableRegistration",checked:a.enableRegistration,onCheckedChange:s=>{t(r=>({...r,enableRegistration:s}))}}),e.jsx(i,{htmlFor:"enableRegistration",children:"السماح بتسجيل مستخدمين جدد"})]}),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(l,{id:"requireEmailVerification",name:"requireEmailVerification",checked:a.requireEmailVerification,onCheckedChange:s=>{t(r=>({...r,requireEmailVerification:s}))}}),e.jsx(i,{htmlFor:"requireEmailVerification",children:"طلب تأكيد البريد الإلكتروني"})]}),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(l,{id:"allowPasswordReset",name:"allowPasswordReset",checked:a.allowPasswordReset,onCheckedChange:s=>{t(r=>({...r,allowPasswordReset:s}))}}),e.jsx(i,{htmlFor:"allowPasswordReset",children:"السماح بإعادة تعيين كلمة المرور"})]})]})]})}),e.jsx(u,{value:"password",className:"space-y-6",children:e.jsxs(m,{children:[e.jsxs(d,{children:[e.jsxs(o,{className:"flex items-center",children:[e.jsx(S,{className:"ml-2 h-5 w-5"}),"إعدادات كلمات المرور"]}),e.jsx(h,{children:"تكوين متطلبات كلمة المرور وسياسات الأمان"})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"minPasswordLength",children:"الحد الأدنى لطول كلمة المرور"}),e.jsx(n,{id:"minPasswordLength",name:"minPasswordLength",type:"number",min:"6",max:"32",value:a.minPasswordLength,onChange:c})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(l,{id:"requireUppercase",name:"requireUppercase",checked:a.requireUppercase,onCheckedChange:s=>{t(r=>({...r,requireUppercase:s}))}}),e.jsx(i,{htmlFor:"requireUppercase",children:"تتطلب أحرفاً كبيرة"})]}),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(l,{id:"requireLowercase",name:"requireLowercase",checked:a.requireLowercase,onCheckedChange:s=>{t(r=>({...r,requireLowercase:s}))}}),e.jsx(i,{htmlFor:"requireLowercase",children:"تتطلب أحرفاً صغيرة"})]}),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(l,{id:"requireNumbers",name:"requireNumbers",checked:a.requireNumbers,onCheckedChange:s=>{t(r=>({...r,requireNumbers:s}))}}),e.jsx(i,{htmlFor:"requireNumbers",children:"تتطلب أرقام"})]}),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(l,{id:"requireSpecialChars",name:"requireSpecialChars",checked:a.requireSpecialChars,onCheckedChange:s=>{t(r=>({...r,requireSpecialChars:s}))}}),e.jsx(i,{htmlFor:"requireSpecialChars",children:"تتطلب رموز خاصة"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"passwordExpirationDays",children:"عدد أيام انتهاء صلاحية كلمات المرور (0 = لا تنتهي)"}),e.jsx(n,{id:"passwordExpirationDays",name:"passwordExpirationDays",type:"number",min:"0",value:a.passwordExpirationDays,onChange:c})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"passwordHistory",children:"عدد كلمات المرور السابقة التي لا يمكن إعادة استخدامها (0 = غير محدود)"}),e.jsx(n,{id:"passwordHistory",name:"passwordHistory",type:"number",min:"0",value:a.passwordHistory,onChange:c})]})]})]})]})}),e.jsx(u,{value:"session",className:"space-y-6",children:e.jsxs(m,{children:[e.jsxs(d,{children:[e.jsxs(o,{className:"flex items-center",children:[e.jsx(q,{className:"ml-2 h-5 w-5"}),"إعدادات الجلسات"]}),e.jsx(h,{children:'تكوين فترات الجلسات وخيارات "تذكرني"'})]}),e.jsx(p,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"sessionTimeout",children:"مدة الجلسة بالثواني (الافتراضي: 86400 - 24 ساعة)"}),e.jsx(n,{id:"sessionTimeout",name:"sessionTimeout",type:"number",min:"300",value:a.sessionTimeout,onChange:c})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"rememberMeDuration",children:'مدة "تذكرني" بالأيام'}),e.jsx(n,{id:"rememberMeDuration",name:"rememberMeDuration",type:"number",min:"1",value:a.rememberMeDuration,onChange:c})]})]})})]})}),e.jsx(u,{value:"email",className:"space-y-6",children:e.jsxs(m,{children:[e.jsxs(d,{children:[e.jsxs(o,{className:"flex items-center",children:[e.jsx(k,{className:"ml-2 h-5 w-5"}),"إعدادات خادم البريد الإلكتروني (SMTP)"]}),e.jsx(h,{children:"تكوين خادم SMTP لإرسال رسائل البريد الإلكتروني للتحقق وإعادة تعيين كلمة المرور"})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"smtpHost",children:"خادم SMTP"}),e.jsx(n,{id:"smtpHost",name:"smtpHost",value:a.smtpHost,onChange:c,placeholder:"smtp.example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"smtpPort",children:"منفذ SMTP"}),e.jsx(n,{id:"smtpPort",name:"smtpPort",type:"number",value:a.smtpPort,onChange:c})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"smtpUsername",children:"اسم المستخدم"}),e.jsx(n,{id:"smtpUsername",name:"smtpUsername",value:a.smtpUsername,onChange:c,placeholder:"user@example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"smtpPassword",children:"كلمة المرور"}),e.jsx(n,{id:"smtpPassword",name:"smtpPassword",type:"password",value:a.smtpPassword,onChange:c})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"smtpFromEmail",children:"البريد الإلكتروني المرسل"}),e.jsx(n,{id:"smtpFromEmail",name:"smtpFromEmail",value:a.smtpFromEmail,onChange:c,placeholder:"noreply@example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"smtpFromName",children:"اسم المرسل"}),e.jsx(n,{id:"smtpFromName",name:"smtpFromName",value:a.smtpFromName,onChange:c,placeholder:"نظام الشهادات"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx(l,{id:"smtpSecure",name:"smtpSecure",checked:a.smtpSecure,onCheckedChange:s=>{t(r=>({...r,smtpSecure:s}))}}),e.jsx(i,{htmlFor:"smtpSecure",children:"استخدام اتصال آمن (SSL/TLS)"})]})]})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(D,{type:"submit",disabled:v||g.isPending,className:"min-w-[120px]",children:v||g.isPending?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"ml-2 h-4 w-4 animate-spin"}),"جاري الحفظ..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"ml-2 h-4 w-4"}),"حفظ الإعدادات"]})})})]})]})}export{X as default};
