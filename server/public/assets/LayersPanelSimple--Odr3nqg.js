import{n as L,r as j,j as e,C as I,s as T,t as E,B as m,v as P,d as M,w as S,x as B}from"./index-DoMHCGG2.js";import{S as D}from"./scroll-area-BaWF6YIt.js";import{L as O}from"./layers-D3_CD2xn.js";import{T as f}from"./type-DWs-uHqd.js";import{I as p}from"./image-CRCqvbIG.js";import{E as N}from"./eye-Co1cENxs.js";import{E as v}from"./zoom-out-eiDS2u6d.js";import{L as $}from"./lock-6HL3vJPU.js";import{C as A}from"./chevron-up-DgjV3eGa.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=L("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),Y=({fields:c,hasTemplateImage:d=!1,templateImageZIndex:x=0,isTemplateImageVisible:h=!0,onFieldsUpdate:o,onLayerClick:w,activeLayerId:g=null,onTemplateImageUpdate:l,onAddField:u})=>{const[n,z]=j.useState([]);j.useEffect(()=>{let s=[...c];d&&s.push({id:-1,name:"template-image",label:"صورة القالب",type:"template",position:{x:0,y:0},zIndex:x,visible:h,isTemplateImage:!0});const t=s.sort((a,r)=>(r.zIndex||0)-(a.zIndex||0));z(t)},[c,d,x,h]);const b=s=>{if(s<=0)return;const t=n[s],a=n[s-1];if(t.isTemplateImage)l&&l((a.zIndex||0)+1,t.visible!==!1);else if(a.isTemplateImage){const r=c.map(i=>i.id===t.id?{...i,zIndex:(x||0)+1}:i);o(r)}else{const r=c.map(i=>i.id===t.id?{...i,zIndex:(a.zIndex||0)+1}:i);o(r)}},C=s=>{if(s>=n.length-1)return;const t=n[s],a=n[s+1];if(t.isTemplateImage)l&&l((a.zIndex||0)-1,t.visible!==!1);else if(a.isTemplateImage){const r=c.map(i=>i.id===t.id?{...i,zIndex:(x||0)-1}:i);o(r)}else{const r=c.map(i=>i.id===t.id?{...i,zIndex:(a.zIndex||0)-1}:i);o(r)}},k=(s,t=!1)=>{if(t)l&&l(x,!h);else{const a=c.map(r=>r.id===s?{...r,visible:r.visible===!1}:r);o(a)}},y=s=>{const t=c.map(a=>a.id===s?{...a,locked:a.locked!==!0}:a);o(t)};return e.jsxs(I,{className:"h-full flex flex-col",children:[e.jsxs(T,{className:"pb-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex",children:[e.jsx(O,{className:"mr-2 h-5 w-5 text-primary"}),e.jsx(E,{children:"الطبقات"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>u("text"),className:"h-8 w-8",title:"إضافة حقل نص",children:e.jsx(f,{className:"h-4 w-4"})}),e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>u("image"),className:"h-8 w-8",title:"إضافة حقل صورة",children:e.jsx(p,{className:"h-4 w-4"})})]})]}),e.jsxs(P,{children:[c.length," حقل ",d?"+ صورة القالب":""]})]}),e.jsx(M,{className:"flex-1 p-0 overflow-hidden",children:e.jsx(D,{className:"h-[calc(100vh-400px)]",children:e.jsx("div",{className:"px-2 pb-4",children:e.jsx("div",{className:"space-y-1 layers-panel-simple",children:n.map((s,t)=>e.jsxs("div",{className:S("flex items-center justify-between p-2 rounded-md layer-item",g===s.id&&!s.isTemplateImage?"bg-primary/10 border-r-2 border-primary":"hover:bg-accent",s.visible===!1&&"opacity-50"),onClick:()=>!s.isTemplateImage&&w(s.id),children:[e.jsxs("div",{className:"flex items-center space-x-2 flex-1",children:[e.jsx("div",{className:"cursor-pointer w-6 h-6 flex items-center justify-center",children:s.isTemplateImage?e.jsx(p,{className:"h-4 w-4 text-primary"}):s.type==="text"?e.jsx(f,{className:"h-4 w-4 text-primary"}):e.jsx(p,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{className:s.isTemplateImage?"template-image-layer":"",children:[e.jsx("span",{className:"font-medium mr-2",dir:"auto",children:s.label||s.name}),e.jsx("span",{className:"text-xs text-muted-foreground opacity-70",children:s.zIndex===0?"":s.zIndex&&s.zIndex>0?`(فوق: ${s.zIndex})`:`(تحت: ${Math.abs(s.zIndex||0)})`})]})]}),e.jsxs("div",{className:"flex items-center space-x-1 overflow-x-auto",children:[e.jsx(m,{variant:"ghost",size:"icon",onClick:a=>{a.stopPropagation(),k(s.id,s.isTemplateImage)},className:"h-7 w-7",children:s.isTemplateImage?h?e.jsx(N,{className:"h-3.5 w-3.5"}):e.jsx(v,{className:"h-3.5 w-3.5"}):s.visible!==!1?e.jsx(N,{className:"h-3.5 w-3.5"}):e.jsx(v,{className:"h-3.5 w-3.5"})}),!s.isTemplateImage&&e.jsx(m,{variant:"ghost",size:"icon",onClick:a=>{a.stopPropagation(),y(s.id)},className:"h-7 w-7",children:s.locked?e.jsx($,{className:"h-3.5 w-3.5"}):e.jsx(H,{className:"h-3.5 w-3.5"})}),e.jsx(m,{variant:"ghost",size:"icon",onClick:a=>{a.stopPropagation(),b(t)},className:"h-7 w-7",disabled:t===0,children:e.jsx(A,{className:"h-3.5 w-3.5"})}),e.jsx(m,{variant:"ghost",size:"icon",onClick:a=>{a.stopPropagation(),C(t)},className:"h-7 w-7",disabled:t===n.length-1,children:e.jsx(B,{className:"h-3.5 w-3.5"})})]})]},s.isTemplateImage?"template-image":`layer-${s.id}`))})})})})]})};export{Y as L};
